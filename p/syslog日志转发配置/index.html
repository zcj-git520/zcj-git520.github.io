<!DOCTYPE html>
<html lang="zh-cn">
    <head><meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1'><meta name='description' content='服务器配置(服务器平台：x86) Rsyslog简介  Rsyslog是一个 syslogd 的多线程增强版，在syslog的基础上扩展了很多其他功能，如数据库支持(MySQL, PostgreSQL、Oracle等)、日志内容筛选、定义日志格式模板等。除了默认的udp协议外，rsyslog还支持tcp协议来接收日志。 目前的linux的发行版都切换为rsyslog  安装Rsyslog  Linux的发行版中预先安装了Rsyslog,无需安装，rsyslogd –v 查看版本 若未安装，以下是安装步骤： 1.ubuntu：sudo apt install rsyslog 2.CentOS：yum install rsyslog  Rsyslog.conf配置文件详解 配置文件位置：/etc/rsyslog.conf #### MODULES #### #定义日志的模块。 $ModLoad imuxsock #imuxsock为模块名，支持本地系统日志的模块。 $ModLoad imjournal #imjournal为模块名，支持对系统日志的访问。 #$ModLoad imklog #imklog为模块名，支持内核日志的模块。 #$ModLoad immark #immark为模块名，支持日志标记。 # Provides UDP syslog reception #提供udp syslog的接收。 #$ModLoad imudp #imudp为模块名，支持udp协议。 #$UDPServerRun 514 #允许514端口接收使用udp和tcp转发来的日志。 # Provides TCP syslog reception #提供tcp syslog的接收。 #$ModLoad imtcp #imtcp为模块名，支持tcp协议。 #$InputTCPServerRun 514 #### GLOBAL DIRECTIVES #### #定义全局日志格式的指令。 # Where to place auxiliary files $WorkDirectory /var/lib/rsyslog #工作目录。 # Use default timestamp format $ActionFileDefaultTemplate RSYSLOG_TraditionalFileFormat #定义日志格式默认模板。 $IncludeConfig /etc/rsyslog.'><title>syslog日志转发配置</title>

<link rel='canonical' href='https://zcj-git520.github.io/p/syslog%E6%97%A5%E5%BF%97%E8%BD%AC%E5%8F%91%E9%85%8D%E7%BD%AE/'>

<link rel="stylesheet" href="/scss/style.min.css"><meta property='og:title' content='syslog日志转发配置'>
<meta property='og:description' content='服务器配置(服务器平台：x86) Rsyslog简介  Rsyslog是一个 syslogd 的多线程增强版，在syslog的基础上扩展了很多其他功能，如数据库支持(MySQL, PostgreSQL、Oracle等)、日志内容筛选、定义日志格式模板等。除了默认的udp协议外，rsyslog还支持tcp协议来接收日志。 目前的linux的发行版都切换为rsyslog  安装Rsyslog  Linux的发行版中预先安装了Rsyslog,无需安装，rsyslogd –v 查看版本 若未安装，以下是安装步骤： 1.ubuntu：sudo apt install rsyslog 2.CentOS：yum install rsyslog  Rsyslog.conf配置文件详解 配置文件位置：/etc/rsyslog.conf #### MODULES #### #定义日志的模块。 $ModLoad imuxsock #imuxsock为模块名，支持本地系统日志的模块。 $ModLoad imjournal #imjournal为模块名，支持对系统日志的访问。 #$ModLoad imklog #imklog为模块名，支持内核日志的模块。 #$ModLoad immark #immark为模块名，支持日志标记。 # Provides UDP syslog reception #提供udp syslog的接收。 #$ModLoad imudp #imudp为模块名，支持udp协议。 #$UDPServerRun 514 #允许514端口接收使用udp和tcp转发来的日志。 # Provides TCP syslog reception #提供tcp syslog的接收。 #$ModLoad imtcp #imtcp为模块名，支持tcp协议。 #$InputTCPServerRun 514 #### GLOBAL DIRECTIVES #### #定义全局日志格式的指令。 # Where to place auxiliary files $WorkDirectory /var/lib/rsyslog #工作目录。 # Use default timestamp format $ActionFileDefaultTemplate RSYSLOG_TraditionalFileFormat #定义日志格式默认模板。 $IncludeConfig /etc/rsyslog.'>
<meta property='og:url' content='https://zcj-git520.github.io/p/syslog%E6%97%A5%E5%BF%97%E8%BD%AC%E5%8F%91%E9%85%8D%E7%BD%AE/'>
<meta property='og:site_name' content='Chengji Zhao&#39;s blog'>
<meta property='og:type' content='article'><meta property='article:section' content='Post' /><meta property='article:published_time' content='2021-09-20T22:00:38&#43;08:00'/><meta property='article:modified_time' content='2021-09-20T22:00:38&#43;08:00'/><meta property='og:image' content='https://zcj-git520.github.io/p/syslog%E6%97%A5%E5%BF%97%E8%BD%AC%E5%8F%91%E9%85%8D%E7%BD%AE/8.png' />
<meta name="twitter:title" content="syslog日志转发配置">
<meta name="twitter:description" content="服务器配置(服务器平台：x86) Rsyslog简介  Rsyslog是一个 syslogd 的多线程增强版，在syslog的基础上扩展了很多其他功能，如数据库支持(MySQL, PostgreSQL、Oracle等)、日志内容筛选、定义日志格式模板等。除了默认的udp协议外，rsyslog还支持tcp协议来接收日志。 目前的linux的发行版都切换为rsyslog  安装Rsyslog  Linux的发行版中预先安装了Rsyslog,无需安装，rsyslogd –v 查看版本 若未安装，以下是安装步骤： 1.ubuntu：sudo apt install rsyslog 2.CentOS：yum install rsyslog  Rsyslog.conf配置文件详解 配置文件位置：/etc/rsyslog.conf #### MODULES #### #定义日志的模块。 $ModLoad imuxsock #imuxsock为模块名，支持本地系统日志的模块。 $ModLoad imjournal #imjournal为模块名，支持对系统日志的访问。 #$ModLoad imklog #imklog为模块名，支持内核日志的模块。 #$ModLoad immark #immark为模块名，支持日志标记。 # Provides UDP syslog reception #提供udp syslog的接收。 #$ModLoad imudp #imudp为模块名，支持udp协议。 #$UDPServerRun 514 #允许514端口接收使用udp和tcp转发来的日志。 # Provides TCP syslog reception #提供tcp syslog的接收。 #$ModLoad imtcp #imtcp为模块名，支持tcp协议。 #$InputTCPServerRun 514 #### GLOBAL DIRECTIVES #### #定义全局日志格式的指令。 # Where to place auxiliary files $WorkDirectory /var/lib/rsyslog #工作目录。 # Use default timestamp format $ActionFileDefaultTemplate RSYSLOG_TraditionalFileFormat #定义日志格式默认模板。 $IncludeConfig /etc/rsyslog."><meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:image" content='https://zcj-git520.github.io/p/syslog%E6%97%A5%E5%BF%97%E8%BD%AC%E5%8F%91%E9%85%8D%E7%BD%AE/8.png' />
    </head>
    <body class="
    article-page has-toc
">
    <script>
        (function() {
            const colorSchemeKey = 'StackColorScheme';
            if(!localStorage.getItem(colorSchemeKey)){
                localStorage.setItem(colorSchemeKey, "auto");
            }
        })();
    </script><script>
    (function() {
        const colorSchemeKey = 'StackColorScheme';
        const colorSchemeItem = localStorage.getItem(colorSchemeKey);
        const supportDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches === true;

        if (colorSchemeItem == 'dark' || colorSchemeItem === 'auto' && supportDarkMode) {
            

            document.documentElement.dataset.scheme = 'dark';
        } else {
            document.documentElement.dataset.scheme = 'light';
        }
    })();
</script>
<div class="container main-container flex 
    
        extended
    
">
    
        <div id="article-toolbar">
            <a href="/" class="back-home">
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-chevron-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <polyline points="15 6 9 12 15 18" />
</svg>



                <span>返回</span>
            </a>
        </div>
    
<main class="main full-width">
    <article class="has-image main-article">
    <header class="article-header">
        <div class="article-image">
            <a href="/p/syslog%E6%97%A5%E5%BF%97%E8%BD%AC%E5%8F%91%E9%85%8D%E7%BD%AE/">
                <img src="/p/syslog%E6%97%A5%E5%BF%97%E8%BD%AC%E5%8F%91%E9%85%8D%E7%BD%AE/8_hu442c80cfdca83249146ebd0d5822289f_88346_800x0_resize_box_3.png"
                        srcset="/p/syslog%E6%97%A5%E5%BF%97%E8%BD%AC%E5%8F%91%E9%85%8D%E7%BD%AE/8_hu442c80cfdca83249146ebd0d5822289f_88346_800x0_resize_box_3.png 800w, /p/syslog%E6%97%A5%E5%BF%97%E8%BD%AC%E5%8F%91%E9%85%8D%E7%BD%AE/8_hu442c80cfdca83249146ebd0d5822289f_88346_1600x0_resize_box_3.png 1600w"
                        width="800" 
                        height="215" 
                        loading="lazy"
                        alt="Featured image of post syslog日志转发配置" />
                
            </a>
        </div>
    

    <div class="article-details">
    
    <header class="article-category">
        
            <a href="/categories/computer/" style="background-color: #2a9d8f; color: #fff;">
                知识学习
            </a>
        
    </header>
    

    <h2 class="article-title">
        <a href="/p/syslog%E6%97%A5%E5%BF%97%E8%BD%AC%E5%8F%91%E9%85%8D%E7%BD%AE/">syslog日志转发配置</a>
    </h2>

    

    
    <footer class="article-time">
        
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <path d="M11.795 21h-6.795a2 2 0 0 1 -2 -2v-12a2 2 0 0 1 2 -2h12a2 2 0 0 1 2 2v4" />
  <circle cx="18" cy="18" r="4" />
  <path d="M15 3v4" />
  <path d="M7 3v4" />
  <path d="M3 11h16" />
  <path d="M18 16.496v1.504l1 1" />
</svg>
                <time class="article-time--published">Sep 20, 2021</time>
            </div>
        

        
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="12" r="9" />
  <polyline points="12 7 12 12 15 15" />
</svg>



                <time class="article-time--reading">
                    阅读时长: 2 分钟
                </time>
            </div>
        
    </footer>
    
</div>
</header>

    <section class="article-content">
    <h2 id="服务器配置服务器平台x86">服务器配置(服务器平台：x86)</h2>
<h3 id="rsyslog简介">Rsyslog简介</h3>
<ul>
<li>Rsyslog是一个 syslogd 的多线程增强版，在syslog的基础上扩展了很多其他功能，如数据库支持(MySQL, PostgreSQL、Oracle等)、日志内容筛选、定义日志格式模板等。除了默认的udp协议外，rsyslog还支持tcp协议来接收日志。</li>
<li>目前的linux的发行版都切换为rsyslog</li>
</ul>
<h3 id="安装rsyslog">安装Rsyslog</h3>
<ul>
<li>Linux的发行版中预先安装了Rsyslog,无需安装，rsyslogd –v 查看版本</li>
<li>若未安装，以下是安装步骤：
1.ubuntu：sudo apt install rsyslog
2.CentOS：yum install rsyslog</li>
</ul>
<h3 id="rsyslogconf配置文件详解">Rsyslog.conf配置文件详解</h3>
<pre tabindex="0"><code>配置文件位置：/etc/rsyslog.conf
#### MODULES ####               #定义日志的模块。
$ModLoad imuxsock             #imuxsock为模块名，支持本地系统日志的模块。
$ModLoad imjournal            #imjournal为模块名，支持对系统日志的访问。
#$ModLoad imklog               #imklog为模块名，支持内核日志的模块。
#$ModLoad immark               #immark为模块名，支持日志标记。
# Provides UDP syslog reception   #提供udp syslog的接收。
#$ModLoad imudp               #imudp为模块名，支持udp协议。
#$UDPServerRun 514               #允许514端口接收使用udp和tcp转发来的日志。
# Provides TCP syslog reception       #提供tcp syslog的接收。
#$ModLoad imtcp              #imtcp为模块名，支持tcp协议。
#$InputTCPServerRun 514

#### GLOBAL DIRECTIVES ####    #定义全局日志格式的指令。
# Where to place auxiliary files
$WorkDirectory /var/lib/rsyslog       #工作目录。
# Use default timestamp format
$ActionFileDefaultTemplate RSYSLOG_TraditionalFileFormat  #定义日志格式默认模板。
$IncludeConfig /etc/rsyslog.d/*.conf                     #所有配置文件路径。
$OmitLocalLogging on                                      #省略本地登录。
# File to store the position in the journal
$IMJournalStateFile imjournal.state

#### RULES ####
#kern.*                                  /dev/console
#记录所有日志类型的info级别以及大于info级别的信息到messages文件，但是mail邮件信息，authpriv验证方面的信息和corn时间和任务相关信息除外。
*.info;mail.none;authpriv.none;cron.none      /var/log/messages

# authpriv验证相关的所有信息存放在/var/log/secure。
authpriv.*                                /var/log/secure

#邮件的所有信息存在/var/log/maillog；这里有一个“-”符号表示是使用异步的方式记录
mail.*                                   -/var/log/maillog

#任务计划有关的信息存放在/var/log/cron。
cron.*                                   /var/log/cron

#记录所有的≥emerg级别信息，发送给每个登录到系统的日志。
*.emerg                                 :omusrmsg:*

#记录uucp，news.crit等存放在/var/log/spooler
uucp,news.crit                            /var/log/spooler

#本地服务器的启动的所有日志存放在/var/log/boot.log
local7.*                                  /var/log/boot.log

以下为：rsyslog 客服端的配置
#发送日志，@表示传输协议（@表示udp，@@表示tcp），后面是ip和端口。
#*.* @@remote-host:514
</code></pre><h3 id="配置服务器">配置服务器</h3>
<ul>
<li>使用sudo vi /etc/rsyslog.conf 打开配置文件</li>
</ul>
<h4 id="选择传输的协议">选择传输的协议</h4>
<p>1.使用udp传输日志，配置时将前面的#去掉即可<br>
$ModLoad imudp<br>
$UDPServerRun 514<br>
2.使用tcp传输协议, 将#去点即可<br>
$ModLoad imtcp<br>
$InputTCPServerRun 514<br>
配置如图：<figure 
	
		class="gallery-image" 
		style="
			flex-grow: 359; 
			flex-basis: 863px"
	>
	<a href="/p/syslog%E6%97%A5%E5%BF%97%E8%BD%AC%E5%8F%91%E9%85%8D%E7%BD%AE/1.png" data-size="554x154">
		<img src="/p/syslog%E6%97%A5%E5%BF%97%E8%BD%AC%E5%8F%91%E9%85%8D%E7%BD%AE/1.png"
			width="554"
			height="154"
			srcset="/p/syslog%E6%97%A5%E5%BF%97%E8%BD%AC%E5%8F%91%E9%85%8D%E7%BD%AE/1_hu77084371b4080a34a3de211f1d39cdb3_32949_480x0_resize_box_3.png 480w, /p/syslog%E6%97%A5%E5%BF%97%E8%BD%AC%E5%8F%91%E9%85%8D%E7%BD%AE/1_hu77084371b4080a34a3de211f1d39cdb3_32949_1024x0_resize_box_3.png 1024w"
			loading="lazy"
			>
	</a>
	
</figure></p>
<ul>
<li>注明：<br>
514/5014端口号可以自己配置，默认为514.<br>
rsyslog后台进程是可以同时监听TCP/UDP连接的</li>
</ul>
<h4 id="配置接收日志模板">配置接收日志模板</h4>
<ul>
<li>在GLOBAL DIRECTIVES内容块的前面增加接收日志模板
模板如下：<br>
$template RemoteLogs,&quot;/var/log/%HOSTNAME%/%PROGRAMNAME%.log&quot;<br>
*.* ?RemoteLogs<br>
&amp; ~</li>
<li>注明：<br>
1、$template RemoteLogs指令（“RemoteLogs” 可以为其它的描述的名字）迫使rsyslog后台进程隔开本地/var/log/下文件去写日志信息。而日志文件名则依据发送远程日志的机器名及应用程序名来定义。<br>
2、*.*  ?RemoteLogs）暗含运行用模板RemoteLogs于所有的接收日志。<br>
3、&amp; ~则告诉rsyslog后台进程停止进一步的去处理日志信息,即不对它们进行本地化写入，它是代表一个重定向规则。如果没有这一行，则意味着接收到的日志会写入两次，一次如前两行写的方式写，第二次则以本地日志记录的方式写入。运行这个规则的另一个结论则是日志服务器自己的日志信息只会写入到依照机器主机名命名的文件中。
<figure 
	
		class="gallery-image" 
		style="
			flex-grow: 426; 
			flex-basis: 1022px"
	>
	<a href="/p/syslog%E6%97%A5%E5%BF%97%E8%BD%AC%E5%8F%91%E9%85%8D%E7%BD%AE/2.png" data-size="554x130">
		<img src="/p/syslog%E6%97%A5%E5%BF%97%E8%BD%AC%E5%8F%91%E9%85%8D%E7%BD%AE/2.png"
			width="554"
			height="130"
			srcset="/p/syslog%E6%97%A5%E5%BF%97%E8%BD%AC%E5%8F%91%E9%85%8D%E7%BD%AE/2_hu3baee738422c39b2b8b3a15300ae6fe7_26443_480x0_resize_box_3.png 480w, /p/syslog%E6%97%A5%E5%BF%97%E8%BD%AC%E5%8F%91%E9%85%8D%E7%BD%AE/2_hu3baee738422c39b2b8b3a15300ae6fe7_26443_1024x0_resize_box_3.png 1024w"
			loading="lazy"
			>
	</a>
	
</figure></li>
<li>设置后，会按照模板格式保存日志
<figure 
	
		class="gallery-image" 
		style="
			flex-grow: 1065; 
			flex-basis: 2556px"
	>
	<a href="/p/syslog%E6%97%A5%E5%BF%97%E8%BD%AC%E5%8F%91%E9%85%8D%E7%BD%AE/3.png" data-size="554x52">
		<img src="/p/syslog%E6%97%A5%E5%BF%97%E8%BD%AC%E5%8F%91%E9%85%8D%E7%BD%AE/3.png"
			width="554"
			height="52"
			srcset="/p/syslog%E6%97%A5%E5%BF%97%E8%BD%AC%E5%8F%91%E9%85%8D%E7%BD%AE/3_hu8eaabc720939b9f1b459055b1ef23fcf_21246_480x0_resize_box_3.png 480w, /p/syslog%E6%97%A5%E5%BF%97%E8%BD%AC%E5%8F%91%E9%85%8D%E7%BD%AE/3_hu8eaabc720939b9f1b459055b1ef23fcf_21246_1024x0_resize_box_3.png 1024w"
			loading="lazy"
			>
	</a>
	
</figure></li>
</ul>
<h4 id="设置完成保存">设置完成，保存</h4>
<h3 id="检查rsyslog配置">检查Rsyslog配置</h3>
<ul>
<li>使用命令：rsyslogd -f /etc/rsyslog.conf -N1</li>
<li>配置信息正确有如下提示:
<figure 
	
		class="gallery-image" 
		style="
			flex-grow: 1259; 
			flex-basis: 3021px"
	>
	<a href="/p/syslog%E6%97%A5%E5%BF%97%E8%BD%AC%E5%8F%91%E9%85%8D%E7%BD%AE/4.png" data-size="554x44">
		<img src="/p/syslog%E6%97%A5%E5%BF%97%E8%BD%AC%E5%8F%91%E9%85%8D%E7%BD%AE/4.png"
			width="554"
			height="44"
			srcset="/p/syslog%E6%97%A5%E5%BF%97%E8%BD%AC%E5%8F%91%E9%85%8D%E7%BD%AE/4_hu7b39900913f27882a0ae7c07277316b2_23299_480x0_resize_box_3.png 480w, /p/syslog%E6%97%A5%E5%BF%97%E8%BD%AC%E5%8F%91%E9%85%8D%E7%BD%AE/4_hu7b39900913f27882a0ae7c07277316b2_23299_1024x0_resize_box_3.png 1024w"
			loading="lazy"
			>
	</a>
	
</figure></li>
<li>若配置信息有误，则需要在更改配置文件</li>
</ul>
<h3 id="重启rsyslog服务">重启RSyslog服务</h3>
<ul>
<li>Debian,Ubuntu或CentOS/RHEL 6使用:sudo service rsyslog restart</li>
<li>Fedora 或 CentOS/RHEL 7使用：sudo systemctl restart rsyslog</li>
<li>使用：sudo lsof -i :[端口号]，查看服务是否开启和tcp/udp连接情况
<figure 
	
		class="gallery-image" 
		style="
			flex-grow: 548; 
			flex-basis: 1316px"
	>
	<a href="/p/syslog%E6%97%A5%E5%BF%97%E8%BD%AC%E5%8F%91%E9%85%8D%E7%BD%AE/5.png" data-size="554x101">
		<img src="/p/syslog%E6%97%A5%E5%BF%97%E8%BD%AC%E5%8F%91%E9%85%8D%E7%BD%AE/5.png"
			width="554"
			height="101"
			srcset="/p/syslog%E6%97%A5%E5%BF%97%E8%BD%AC%E5%8F%91%E9%85%8D%E7%BD%AE/5_hub384d36617421245c9364162c8094a34_49314_480x0_resize_box_3.png 480w, /p/syslog%E6%97%A5%E5%BF%97%E8%BD%AC%E5%8F%91%E9%85%8D%E7%BD%AE/5_hub384d36617421245c9364162c8094a34_49314_1024x0_resize_box_3.png 1024w"
			loading="lazy"
			>
	</a>
	
</figure></li>
<li>或使用sudo netstat -pantu | grep rsyslog
<figure 
	
		class="gallery-image" 
		style="
			flex-grow: 748; 
			flex-basis: 1796px"
	>
	<a href="/p/syslog%E6%97%A5%E5%BF%97%E8%BD%AC%E5%8F%91%E9%85%8D%E7%BD%AE/6.png" data-size="554x74">
		<img src="/p/syslog%E6%97%A5%E5%BF%97%E8%BD%AC%E5%8F%91%E9%85%8D%E7%BD%AE/6.png"
			width="554"
			height="74"
			srcset="/p/syslog%E6%97%A5%E5%BF%97%E8%BD%AC%E5%8F%91%E9%85%8D%E7%BD%AE/6_hud96afeb39ab29624ebbfb8d879fa92f8_35198_480x0_resize_box_3.png 480w, /p/syslog%E6%97%A5%E5%BF%97%E8%BD%AC%E5%8F%91%E9%85%8D%E7%BD%AE/6_hud96afeb39ab29624ebbfb8d879fa92f8_35198_1024x0_resize_box_3.png 1024w"
			loading="lazy"
			>
	</a>
	
</figure></li>
</ul>
<h3 id="查看日志">查看日志</h3>
<ul>
<li>启动客户端，进入配置文件模板中日志保存的位置：<br>
<figure 
	
		class="gallery-image" 
		style="
			flex-grow: 971; 
			flex-basis: 2332px"
	>
	<a href="/p/syslog%E6%97%A5%E5%BF%97%E8%BD%AC%E5%8F%91%E9%85%8D%E7%BD%AE/7.png" data-size="554x57">
		<img src="/p/syslog%E6%97%A5%E5%BF%97%E8%BD%AC%E5%8F%91%E9%85%8D%E7%BD%AE/7.png"
			width="554"
			height="57"
			srcset="/p/syslog%E6%97%A5%E5%BF%97%E8%BD%AC%E5%8F%91%E9%85%8D%E7%BD%AE/7_hu31450327525b5e8e578d50ab58e1813e_22403_480x0_resize_box_3.png 480w, /p/syslog%E6%97%A5%E5%BF%97%E8%BD%AC%E5%8F%91%E9%85%8D%E7%BD%AE/7_hu31450327525b5e8e578d50ab58e1813e_22403_1024x0_resize_box_3.png 1024w"
			loading="lazy"
			>
	</a>
	
</figure><br>
<figure 
	
		class="gallery-image" 
		style="
			flex-grow: 371; 
			flex-basis: 892px"
	>
	<a href="/p/syslog%E6%97%A5%E5%BF%97%E8%BD%AC%E5%8F%91%E9%85%8D%E7%BD%AE/8.png" data-size="554x149">
		<img src="/p/syslog%E6%97%A5%E5%BF%97%E8%BD%AC%E5%8F%91%E9%85%8D%E7%BD%AE/8.png"
			width="554"
			height="149"
			srcset="/p/syslog%E6%97%A5%E5%BF%97%E8%BD%AC%E5%8F%91%E9%85%8D%E7%BD%AE/8_hu442c80cfdca83249146ebd0d5822289f_88346_480x0_resize_box_3.png 480w, /p/syslog%E6%97%A5%E5%BF%97%E8%BD%AC%E5%8F%91%E9%85%8D%E7%BD%AE/8_hu442c80cfdca83249146ebd0d5822289f_88346_1024x0_resize_box_3.png 1024w"
			loading="lazy"
			>
	</a>
	
</figure></li>
<li>若没有生成日志文件，需要使用：sudo tcpdump host 客户端ip 查看是否转发日志，有则是保存模板出问题，没有可能的服务端配置或者客户端配置出问题<br>
<figure 
	
		class="gallery-image" 
		style="
			flex-grow: 415; 
			flex-basis: 997px"
	>
	<a href="/p/syslog%E6%97%A5%E5%BF%97%E8%BD%AC%E5%8F%91%E9%85%8D%E7%BD%AE/9.png" data-size="553x133">
		<img src="/p/syslog%E6%97%A5%E5%BF%97%E8%BD%AC%E5%8F%91%E9%85%8D%E7%BD%AE/9.png"
			width="553"
			height="133"
			srcset="/p/syslog%E6%97%A5%E5%BF%97%E8%BD%AC%E5%8F%91%E9%85%8D%E7%BD%AE/9_hud06aeafa785a175b3e704d37bde11243_109835_480x0_resize_box_3.png 480w, /p/syslog%E6%97%A5%E5%BF%97%E8%BD%AC%E5%8F%91%E9%85%8D%E7%BD%AE/9_hud06aeafa785a175b3e704d37bde11243_109835_1024x0_resize_box_3.png 1024w"
			loading="lazy"
			>
	</a>
	
</figure></li>
</ul>
<h2 id="客户端配置">客户端配置</h2>
<h3 id="平台x86">平台：x86</h3>
<ul>
<li>平台是使用的rsyslog</li>
<li>使用sudo vi /etc/rsyslog.conf 打开配置文件</li>
<li>配置：<br>
发送日志，@表示传输协议（@表示udp，@@表示tcp），后面是ip和端口。<br>
*.* @@remote-host:514</li>
</ul>
<p><figure 
	
		class="gallery-image" 
		style="
			flex-grow: 769; 
			flex-basis: 1846px"
	>
	<a href="/p/syslog%E6%97%A5%E5%BF%97%E8%BD%AC%E5%8F%91%E9%85%8D%E7%BD%AE/10.png" data-size="554x72">
		<img src="/p/syslog%E6%97%A5%E5%BF%97%E8%BD%AC%E5%8F%91%E9%85%8D%E7%BD%AE/10.png"
			width="554"
			height="72"
			srcset="/p/syslog%E6%97%A5%E5%BF%97%E8%BD%AC%E5%8F%91%E9%85%8D%E7%BD%AE/10_hu121ce9beda989ac489d36785534a4c07_11404_480x0_resize_box_3.png 480w, /p/syslog%E6%97%A5%E5%BF%97%E8%BD%AC%E5%8F%91%E9%85%8D%E7%BD%AE/10_hu121ce9beda989ac489d36785534a4c07_11404_1024x0_resize_box_3.png 1024w"
			loading="lazy"
			>
	</a>
	
</figure></p>
<ul>
<li>检查与重启服务和x86服务器平台一样</li>
</ul>
<h3 id="平台开发板">平台开发板</h3>
<ul>
<li>板子是使用的syslog 使用命令：ps进行查看进程<br>
<figure 
	
		class="gallery-image" 
		style="
			flex-grow: 266; 
			flex-basis: 639px"
	>
	<a href="/p/syslog%E6%97%A5%E5%BF%97%E8%BD%AC%E5%8F%91%E9%85%8D%E7%BD%AE/11.png" data-size="554x208">
		<img src="/p/syslog%E6%97%A5%E5%BF%97%E8%BD%AC%E5%8F%91%E9%85%8D%E7%BD%AE/11.png"
			width="554"
			height="208"
			srcset="/p/syslog%E6%97%A5%E5%BF%97%E8%BD%AC%E5%8F%91%E9%85%8D%E7%BD%AE/11_hu4e6e3e2c799b4a539a43c7ac3ef0cfea_64168_480x0_resize_box_3.png 480w, /p/syslog%E6%97%A5%E5%BF%97%E8%BD%AC%E5%8F%91%E9%85%8D%E7%BD%AE/11_hu4e6e3e2c799b4a539a43c7ac3ef0cfea_64168_1024x0_resize_box_3.png 1024w"
			loading="lazy"
			>
	</a>
	
</figure></li>
<li>找到syslogd服务，若未找到，可能不支持syslog服务
使用命令：syslogd –h 查看syslogd支持的服务<br>
<figure 
	
		class="gallery-image" 
		style="
			flex-grow: 271; 
			flex-basis: 651px"
	>
	<a href="/p/syslog%E6%97%A5%E5%BF%97%E8%BD%AC%E5%8F%91%E9%85%8D%E7%BD%AE/12.png" data-size="554x204">
		<img src="/p/syslog%E6%97%A5%E5%BF%97%E8%BD%AC%E5%8F%91%E9%85%8D%E7%BD%AE/12.png"
			width="554"
			height="204"
			srcset="/p/syslog%E6%97%A5%E5%BF%97%E8%BD%AC%E5%8F%91%E9%85%8D%E7%BD%AE/12_hu303331932f04e72e99ec8f8ee7478f8d_60851_480x0_resize_box_3.png 480w, /p/syslog%E6%97%A5%E5%BF%97%E8%BD%AC%E5%8F%91%E9%85%8D%E7%BD%AE/12_hu303331932f04e72e99ec8f8ee7478f8d_60851_1024x0_resize_box_3.png 1024w"
			loading="lazy"
			>
	</a>
	
</figure></li>
</ul>
<h3 id="配置客户端">配置客户端</h3>
<p>1.结束之前的syslogd服务，通过使用kill 进程号 结束进程<br>
<figure 
	
		class="gallery-image" 
		style="
			flex-grow: 537; 
			flex-basis: 1290px"
	>
	<a href="/p/syslog%E6%97%A5%E5%BF%97%E8%BD%AC%E5%8F%91%E9%85%8D%E7%BD%AE/13.png" data-size="554x103">
		<img src="/p/syslog%E6%97%A5%E5%BF%97%E8%BD%AC%E5%8F%91%E9%85%8D%E7%BD%AE/13.png"
			width="554"
			height="103"
			srcset="/p/syslog%E6%97%A5%E5%BF%97%E8%BD%AC%E5%8F%91%E9%85%8D%E7%BD%AE/13_hu9fb7ecb2769d8f203208712c5df5625e_31804_480x0_resize_box_3.png 480w, /p/syslog%E6%97%A5%E5%BF%97%E8%BD%AC%E5%8F%91%E9%85%8D%E7%BD%AE/13_hu9fb7ecb2769d8f203208712c5df5625e_31804_1024x0_resize_box_3.png 1024w"
			loading="lazy"
			>
	</a>
	
</figure>
2.通过syslogd提供的服务是通过 -L  –R 服务器的ip:port<br>
注明：默认端口为：514,端口号应该与服务器配置的端口号一致<br>
3.启动syslogd服务：/sbin/syslogd -f /etc/syslog.conf -L -R 172.16.193.204:514
4.通过tcpdump host 172.16.193.204 查看日志是否被转发到服务器<br>
<figure 
	
		class="gallery-image" 
		style="
			flex-grow: 537; 
			flex-basis: 1290px"
	>
	<a href="/p/syslog%E6%97%A5%E5%BF%97%E8%BD%AC%E5%8F%91%E9%85%8D%E7%BD%AE/13.png" data-size="554x103">
		<img src="/p/syslog%E6%97%A5%E5%BF%97%E8%BD%AC%E5%8F%91%E9%85%8D%E7%BD%AE/13.png"
			width="554"
			height="103"
			srcset="/p/syslog%E6%97%A5%E5%BF%97%E8%BD%AC%E5%8F%91%E9%85%8D%E7%BD%AE/13_hu9fb7ecb2769d8f203208712c5df5625e_31804_480x0_resize_box_3.png 480w, /p/syslog%E6%97%A5%E5%BF%97%E8%BD%AC%E5%8F%91%E9%85%8D%E7%BD%AE/13_hu9fb7ecb2769d8f203208712c5df5625e_31804_1024x0_resize_box_3.png 1024w"
			loading="lazy"
			>
	</a>
	
</figure></p>
<ul>
<li>注明：开发板的syslog支持UDP传输，需要开发板的日志文件需要在服务器打开UDP</li>
</ul>

</section>


    <footer class="article-footer">
    

    
    <section class="article-copyright">
        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="12" r="9" />
  <path d="M14.5 9a3.5 4 0 1 0 0 6" />
</svg>



        <span>Licensed under CC BY-NC-SA 4.0</span>
    </section>
    </footer>


    
</article>

    <aside class="related-contents--wrapper">
    
    
        <h2 class="section-title">相关文章</h2>
        <div class="related-contents">
            <div class="flex article-list--tile">
                
                    
<article class="has-image">
    <a href="/p/c/c-/">
        
        
            <div class="article-image">
                <img src="/p/c/c/10.8077ca6d9a0decc584ac5cd6212df5bf_hu5bb3a4baa791897c79c1df91e792ef0e_243913_250x150_fill_box_smart1_3.png" 
                        width="250" 
                        height="150" 
                        loading="lazy" 
                        data-key="c/c&#43;&#43;" 
                        data-hash="md5-gHfKbZoN7MWErFzWIS31vw==">
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">进程、线程、协程</h2>
        </div>
    </a>
</article>
                
                    
<article class="">
    <a href="/p/%E6%88%91%E7%9A%84%E7%AC%AC%E4%B8%80%E4%BB%BD%E5%8D%9A%E5%AE%A2/">
        
        

        <div class="article-details">
            <h2 class="article-title">我的第一份博客</h2>
        </div>
    </a>
</article>
                
            </div>
        </div>
    
</aside>

     
    
        
    

    <footer class="site-footer">
    <section class="copyright">
        &copy; 
        
            2020 - 
        
        2021 Chengji Zhao&#39;s blog
    </section>
    
    <section class="powerby">
        Built with <a href="https://gohugo.io/" target="_blank" rel="noopener">Hugo</a> <br />
        Theme <b><a href="https://github.com/CaiJimmy/hugo-theme-stack" target="_blank" rel="noopener" data-version="3.2.0">Stack</a></b> designed by <a href="https://jimmycai.com" target="_blank" rel="noopener">Jimmy</a>
    </section>
</footer>


    
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    
    <div class="pswp__bg"></div>

    
    <div class="pswp__scroll-wrap">

        
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                
                
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                        <div class="pswp__preloader__cut">
                            <div class="pswp__preloader__donut"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js"integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo="crossorigin="anonymous"
                defer="true"
                >
            </script><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js"integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU="crossorigin="anonymous"
                defer="true"
                >
            </script><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.css"integrity="sha256-c0uckgykQ9v5k&#43;IqViZOZKc47Jn7KQil4/MP3ySA3F8="crossorigin="anonymous"
            ><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.css"integrity="sha256-SBLU4vv6CA6lHsZ1XyTdhyjJxCjPif/TRkjnsyGAGnE="crossorigin="anonymous"
            >

            </main>
    
        <aside class="sidebar right-sidebar sticky">
            <section class="widget archives">
                <div class="widget-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <line x1="5" y1="9" x2="19" y2="9" />
  <line x1="5" y1="15" x2="19" y2="15" />
  <line x1="11" y1="4" x2="7" y2="20" />
  <line x1="17" y1="4" x2="13" y2="20" />
</svg>



                </div>
                <h2 class="widget-title section-title">目录</h2>
                
                <div class="widget--toc">
                    <nav id="TableOfContents">
  <ol>
    <li><a href="#服务器配置服务器平台x86">服务器配置(服务器平台：x86)</a>
      <ol>
        <li><a href="#rsyslog简介">Rsyslog简介</a></li>
        <li><a href="#安装rsyslog">安装Rsyslog</a></li>
        <li><a href="#rsyslogconf配置文件详解">Rsyslog.conf配置文件详解</a></li>
        <li><a href="#配置服务器">配置服务器</a>
          <ol>
            <li><a href="#选择传输的协议">选择传输的协议</a></li>
            <li><a href="#配置接收日志模板">配置接收日志模板</a></li>
            <li><a href="#设置完成保存">设置完成，保存</a></li>
          </ol>
        </li>
        <li><a href="#检查rsyslog配置">检查Rsyslog配置</a></li>
        <li><a href="#重启rsyslog服务">重启RSyslog服务</a></li>
        <li><a href="#查看日志">查看日志</a></li>
      </ol>
    </li>
    <li><a href="#客户端配置">客户端配置</a>
      <ol>
        <li><a href="#平台x86">平台：x86</a></li>
        <li><a href="#平台开发板">平台开发板</a></li>
        <li><a href="#配置客户端">配置客户端</a></li>
      </ol>
    </li>
  </ol>
</nav>
                </div>
            </section>
        </aside>
    

        </div>
        <script 
                src="https://cdn.jsdelivr.net/npm/node-vibrant@3.1.5/dist/vibrant.min.js"integrity="sha256-5NovOZc4iwiAWTYIFiIM7DxKUXKWvpVEuMEPLzcm5/g="crossorigin="anonymous"
                defer="false"
                >
            </script><script type="text/javascript" src="/ts/main.js" defer></script>
<script>
    (function () {
        const customFont = document.createElement('link');
        customFont.href = "https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap";

        customFont.type = "text/css";
        customFont.rel = "stylesheet";

        document.head.appendChild(customFont);
    }());
</script>

    </body>
</html>
